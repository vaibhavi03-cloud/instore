<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Supermarket Navigation</title>
<style>
  body {
    font-family: "Segoe UI", sans-serif;
    background: linear-gradient(135deg, #eaf4ff, #fefefe);
    margin: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  h1 {
    color: #0066cc;
    margin-top: 15px;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.15);
  }

  #controls {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
    margin: 15px 0;
  }

  select, input, button {
    padding: 8px 10px;
    border-radius: 8px;
    border: 1px solid #0078d7;
    font-size: 14px;
  }

  button {
    background-color: #0078d7;
    color: white;
    cursor: pointer;
    transition: 0.3s;
  }

  button:hover {
    background-color: #005fa3;
  }

  #itemList {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
    gap: 15px;
    width: 90%;
    margin-bottom: 15px;
  }

  .card {
    background: #ffffff;
    border-radius: 12px;
    padding: 10px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    text-align: center;
    transition: transform 0.3s;
  }

  .card:hover {
    transform: scale(1.03);
  }

  .selected {
    border: 2px solid #0078d7;
    background-color: #e6f2ff;
  }

  #mapContainer {
    perspective: 1000px;
  }

  svg {
    background: #ffffff;
    border: 2px solid #0078d7;
    border-radius: 12px;
    width: 90%;
    height: 600px;
    margin-bottom: 10px;
    transition: transform 1.2s ease-in-out;
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
  }

  #routeInfo {
    display: none;
    background: #e6f7ff;
    border: 1px solid #0078d7;
    border-radius: 10px;
    padding: 10px;
    width: 80%;
    font-size: 16px;
    margin-bottom: 15px;
  }

  #legend {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 15px;
    background: white;
    border-radius: 10px;
    padding: 10px;
    width: 80%;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    font-size: 14px;
  }

  .legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .color-box {
    width: 16px;
    height: 16px;
    border-radius: 3px;
    border: 1px solid #999;
  }

  @keyframes moveDot {
    to {
      offset-distance: 100%;
    }
  }
</style>
</head>

<body>
  <h1>üè¨ Smart Supermarket Navigation System</h1>
  <div id="controls">
    <input type="text" id="searchBox" placeholder="üîç Search item..." oninput="filterItems()">
    <select id="categoryFilter" onchange="filterItems()">
      <option value="">All Categories</option>
      <option value="Fruits">Fruits</option>
      <option value="Vegetables">Vegetables</option>
      <option value="Dairy">Dairy</option>
      <option value="Bakery">Bakery</option>
      <option value="Electronics">Electronics</option>
      <option value="Clothing">Clothing</option>
    </select>
    <select id="floorFilter" onchange="changeFloor()">
      <option value="Ground Floor">Ground Floor</option>
      <option value="First Floor">First Floor</option>
    </select>
    <button onclick="showRoute()">üó∫Ô∏è Show Route</button>
  </div>

  <div id="itemList"></div>
  <div id="mapContainer"><svg id="storeMap"></svg></div>
  <div id="routeInfo"></div>

  <div id="legend">
    <div class="legend-item"><div class="color-box" style="background:#ffe6e6;"></div> Fruits</div>
    <div class="legend-item"><div class="color-box" style="background:#e6ffe6;"></div> Vegetables</div>
    <div class="legend-item"><div class="color-box" style="background:#e6f0ff;"></div> Dairy</div>
    <div class="legend-item"><div class="color-box" style="background:#fff3e6;"></div> Bakery</div>
    <div class="legend-item"><div class="color-box" style="background:#e6f7ff;"></div> Electronics</div>
    <div class="legend-item"><div class="color-box" style="background:#f5e6ff;"></div> Clothing</div>
    <div class="legend-item"><div class="color-box" style="background:#ffdd57;"></div> Facilities</div>
  </div>

<script>
const svg = document.getElementById("storeMap");
let currentFloor = "Ground Floor";
let selectedItems = new Set();
let currentLocation = {x: 60, y: 550, floor: "Ground Floor"};
let items = [];

const categoryData = {
  "Ground Floor": {
    "Fruits": ["üçé Apple", "üçå Banana", "üçä Orange", "üçá Grapes", "üçì Strawberry", "üçâ Watermelon"],
    "Vegetables": ["ü•î Potato", "ü•ï Carrot", "üßÖ Onion", "üßÑ Garlic", "üåΩ Corn", "ü•¶ Broccoli"],
    "Dairy": ["ü•õ Milk", "üßÄ Cheese", "üç¶ Ice Cream", "üç∂ Yogurt", "üßà Butter"],
    "Bakery": ["ü•ñ Bread", "üç© Donut", "ü•ê Croissant", "üç™ Cookies", "üç∞ Cake"]
  },
  "First Floor": {
    "Electronics": ["üíª Laptop", "üì± Smartphone", "üéß Headphones", "üì∫ TV", "‚åö Smartwatch"],
    "Clothing": ["üëï T-shirt", "üëñ Jeans", "üëó Dress", "üß• Jacket", "üëü Shoes"]
  }
};

const colors = {
  "Fruits": "#ffe6e6",
  "Vegetables": "#e6ffe6",
  "Dairy": "#e6f0ff",
  "Bakery": "#fff3e6",
  "Electronics": "#e6f7ff",
  "Clothing": "#f5e6ff",
  "Facility": "#ffdd57"
};

function generateItems() {
  let y = 100, x = 100;
  for (let floor in categoryData) {
    for (let [category, names] of Object.entries(categoryData[floor])) {
      names.forEach((name, i) => {
        items.push({
          name,
          brand: ["FreshFarm", "DailyMart", "PrimeChoice"][i % 3],
          floor,
          category,
          cost: Math.floor(Math.random() * 400) + 50,
          x: x + (i * 90),
          y: y
        });
      });
      y += 90;
      if (y > 400) { y = 100; x += 180; }
    }
  }
  items.push({ name: "üöª Washroom", floor: "Ground Floor", category: "Facility", x: 60, y: 500 });
  items.push({ name: "üõó Lift", floor: "Ground Floor", category: "Facility", x: 550, y: 500 });
  items.push({ name: "üõó Lift", floor: "First Floor", category: "Facility", x: 550, y: 500 });
  items.push({ name: "üßç‚Äç‚ôÇÔ∏è Trial Room", floor: "First Floor", category: "Facility", x: 900, y: 450 });
}
generateItems();

function displayItems(filtered = items) {
  const list = document.getElementById("itemList");
  list.innerHTML = "";
  filtered.forEach(item => {
    if (item.floor !== currentFloor || item.category === "Facility") return;
    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `
      <h3>${item.name}</h3>
      <p>Brand: ${item.brand}</p>
      <p>Category: ${item.category}</p>
      <p>Cost: ‚Çπ${item.cost}</p>
      <button onclick="toggleSelect('${item.name}', this)">Select</button>`;
    list.appendChild(div);
  });
}

function drawMap() {
  svg.innerHTML = "";
  const start = document.createElementNS("http://www.w3.org/2000/svg", "circle");
  start.setAttribute("cx", currentLocation.x);
  start.setAttribute("cy", currentLocation.y);
  start.setAttribute("r", 12);
  start.setAttribute("fill", "blue");
  svg.appendChild(start);

  items.forEach(item => {
    if (item.floor !== currentFloor) return;
    const rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
    rect.setAttribute("x", item.x);
    rect.setAttribute("y", item.y);
    rect.setAttribute("width", 70);
    rect.setAttribute("height", 50);
    rect.setAttribute("fill", colors[item.category] || "#ffffff");
    rect.setAttribute("stroke", "#0078d7");
    rect.setAttribute("rx", 10);
    svg.appendChild(rect);

    const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
    text.setAttribute("x", item.x + 35);
    text.setAttribute("y", item.y + 30);
    text.setAttribute("text-anchor", "middle");
    text.setAttribute("font-size", "11");
    text.textContent = item.name;
    svg.appendChild(text);
  });
}

function toggleSelect(name, btn) {
  if (selectedItems.has(name)) {
    selectedItems.delete(name);
    btn.innerText = "Select";
    btn.parentElement.classList.remove("selected");
  } else {
    selectedItems.add(name);
    btn.innerText = "Deselect";
    btn.parentElement.classList.add("selected");
  }
}

function filterItems() {
  const search = document.getElementById("searchBox").value.toLowerCase();
  const category = document.getElementById("categoryFilter").value;
  const filtered = items.filter(i =>
    i.name.toLowerCase().includes(search) &&
    (category === "" || i.category === category) &&
    i.floor === currentFloor
  );
  displayItems(filtered);
}

function changeFloor() {
  const svgEl = document.getElementById("storeMap");
  svgEl.style.transform = currentFloor === "Ground Floor"
    ? "rotateX(90deg)"
    : "rotateX(-90deg)";

  setTimeout(() => {
    currentFloor = document.getElementById("floorFilter").value;
    displayItems();
    drawMap();
    svgEl.style.transform = "rotateX(0deg)";
  }, 600);
}

function speak(text) {
  const msg = new SpeechSynthesisUtterance(text);
  msg.lang = "en-IN";
  msg.rate = 1;
  speechSynthesis.speak(msg);
}

function showRoute() {
  if (selectedItems.size === 0) {
    alert("Select at least one item!");
    speak("Please select at least one item to navigate.");
    return;
  }

  const routeInfo = document.getElementById("routeInfo");
  const selected = items.filter(i => selectedItems.has(i.name));
  const grouped = {};
  selected.forEach(i => {
    if (!grouped[i.floor]) grouped[i.floor] = [];
    grouped[i.floor].push(i);
  });

  let routeText = "";
  for (let floor in grouped) {
    routeText += `üß≠ ${floor}: ${grouped[floor].map(i => i.name).join(", ")}<br>`;
  }

  routeInfo.innerHTML = routeText;
  routeInfo.style.display = "block";
  speak("Starting navigation...");

  for (let floor in grouped) {
    speak(`Move to ${floor}`);
    grouped[floor].forEach(item => speak(`Find ${item.name} in ${item.category} section.`));
  }

  drawMap();
  let floorItems = grouped[currentFloor] || [];
  if (floorItems.length === 0) return;

  let pathData = `M${currentLocation.x},${currentLocation.y}`;
  floorItems.forEach(item => pathData += ` L${item.x + 35},${item.y + 25}`);
  const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
  path.setAttribute("d", pathData);
  path.setAttribute("fill", "none");
  path.setAttribute("stroke", "#0078d7");
  path.setAttribute("stroke-width", "4");
  path.setAttribute("stroke-dasharray", "6,8");
  svg.appendChild(path);

  const dot = document.createElementNS("http://www.w3.org/2000/svg", "circle");
  dot.setAttribute("r", 8);
  dot.setAttribute("fill", "red");
  dot.style.offsetPath = `path('${pathData}')`;
  dot.style.animation = "moveDot 6s linear infinite";
  svg.appendChild(dot);
}

displayItems();
drawMap();
</script>
</body>
</html>
