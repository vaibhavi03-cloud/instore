<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üè¨ Smart Mall Navigator</title>
<style>
body {
  font-family: "Poppins", sans-serif;
  background: linear-gradient(180deg, #e9f2ff, #ffffff);
  margin: 0;
  padding: 0;
  text-align: center;
}
header {
  background: linear-gradient(90deg, #0066ff, #00bfff);
  color: white;
  padding: 1rem;
  font-size: 1.8rem;
  font-weight: 700;
  letter-spacing: 1px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.25);
}
.controls {
  margin: 15px auto;
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 10px;
}
select, button {
  padding: 10px 14px;
  border-radius: 10px;
  border: 1px solid #007bff;
  font-size: 16px;
  cursor: pointer;
  transition: 0.3s ease;
}
button {
  background: linear-gradient(90deg, #007bff, #00d4ff);
  color: white;
  border: none;
  font-weight: 600;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}
button:hover {
  transform: scale(1.05);
}
svg {
  display: block;
  margin: 20px auto;
  background: #f7fbff;
  border-radius: 18px;
  box-shadow: 0 0 25px rgba(0,0,0,0.15);
}
.store {
  fill: #ffffff;
  stroke: #0078ff;
  stroke-width: 2;
  rx: 12;
  ry: 12;
  transition: all 0.3s ease;
}
.store:hover {
  fill: #cde3ff;
  transform: scale(1.05);
}
.facility {
  fill: #fff4cc;
  stroke: #ffc107;
}
text {
  font-size: 13px;
  text-anchor: middle;
  alignment-baseline: middle;
  pointer-events: none;
}
.current-location {
  fill: #007bff;
}
.path {
  stroke: #007bff;
  stroke-width: 3;
  stroke-dasharray: 8 5;
  fill: none;
}
</style>
</head>
<body>

<header>üè¨ Smart Multi-Floor Mall Navigator</header>

<div class="controls">
  <select id="floorSelect" onchange="changeFloor()">
    <option value="Ground Floor">Ground Floor</option>
    <option value="First Floor">First Floor</option>
  </select>

  <select id="destination">
    <option value="">-- Select Destination --</option>
  </select>

  <button onclick="findRoute()">üß≠ Start Navigation</button>
</div>

<svg id="map" width="1000" height="600"></svg>

<script>
const mallData = {
  "Ground Floor": [
    { name: "üëó H&M", x: 120, y: 100 },
    { name: "üëû Bata", x: 220, y: 100 },
    { name: "üëú Lifestyle", x: 320, y: 100 },
    { name: "üíÑ Sephora", x: 420, y: 100 },
    { name: "üì± Samsung", x: 600, y: 100 },
    { name: "üíª Apple Store", x: 700, y: 100 },
    { name: "üéØ GameZone", x: 800, y: 100 },
    { name: "üé¨ PVR Cinemas", x: 900, y: 100 },
    { name: "üçî McDonald's", x: 150, y: 350 },
    { name: "‚òï Starbucks", x: 250, y: 350 },
    { name: "üçï Pizza Hut", x: 350, y: 350 },
    { name: "üç£ Sushi Bar", x: 450, y: 350 },
    { name: "ü•§ KFC", x: 600, y: 350 },
    { name: "üç© Dunkin'", x: 700, y: 350 },
    { name: "üç¶ Baskin Robbins", x: 800, y: 350 },
    { name: "üõó Lift", x: 480, y: 500, facility: true },
    { name: "üöª Washroom", x: 880, y: 500, facility: true }
  ],
  "First Floor": [
    { name: "üëï Zara", x: 120, y: 100 },
    { name: "üß• Allen Solly", x: 220, y: 100 },
    { name: "üß¥ Forest Essentials", x: 320, y: 100 },
    { name: "üíÖ Nykaa", x: 420, y: 100 },
    { name: "üì∑ Reliance Digital", x: 600, y: 100 },
    { name: "üé≥ Bowling Alley", x: 700, y: 100 },
    { name: "üé§ Karaoke Club", x: 800, y: 100 },
    { name: "üéÆ VR World", x: 900, y: 100 },
    { name: "üç± Food Express", x: 150, y: 350 },
    { name: "üçó Barbeque Nation", x: 250, y: 350 },
    { name: "üçú Noodle Hub", x: 350, y: 350 },
    { name: "üçõ Curry Leaf", x: 450, y: 350 },
    { name: "üçü Burger King", x: 600, y: 350 },
    { name: "üçß Cream Stone", x: 700, y: 350 },
    { name: "üç´ Chocolate Room", x: 800, y: 350 },
    { name: "üõó Lift", x: 480, y: 500, facility: true },
    { name: "üöª Washroom", x: 880, y: 500, facility: true }
  ]
};

let currentFloor = "Ground Floor";
let svg = document.getElementById("map");
let movingDot = null;

function drawMall() {
  svg.innerHTML = "";
  const data = mallData[currentFloor];

  data.forEach(store => {
    const rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
    rect.setAttribute("x", store.x);
    rect.setAttribute("y", store.y);
    rect.setAttribute("width", 80);
    rect.setAttribute("height", 50);
    rect.setAttribute("class", store.facility ? "facility" : "store");
    svg.appendChild(rect);

    const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
    text.setAttribute("x", store.x + 40);
    text.setAttribute("y", store.y + 28);
    text.textContent = store.name;
    svg.appendChild(text);
  });

  // Entry point
  const entry = document.createElementNS("http://www.w3.org/2000/svg", "circle");
  entry.setAttribute("cx", 60);
  entry.setAttribute("cy", 560);
  entry.setAttribute("r", 10);
  entry.setAttribute("class", "current-location");
  svg.appendChild(entry);
}

function populateDestinations() {
  const dropdown = document.getElementById("destination");
  dropdown.innerHTML = "<option value=''>-- Select Destination --</option>";
  Object.keys(mallData).forEach(floor => {
    mallData[floor].forEach(store => {
      if (!store.facility) {
        const opt = document.createElement("option");
        opt.value = JSON.stringify({ ...store, floor });
        opt.textContent = `${store.name} (${floor})`;
        dropdown.appendChild(opt);
      }
    });
  });
}

function speak(msg) {
  const utter = new SpeechSynthesisUtterance(msg);
  utter.lang = "en-IN";
  speechSynthesis.speak(utter);
}

function changeFloor() {
  currentFloor = document.getElementById("floorSelect").value;
  drawMall();
}

function findRoute() {
  const val = document.getElementById("destination").value;
  if (!val) return alert("Please select your destination.");
  const dest = JSON.parse(val);

  speak(`Navigating to ${dest.name}`);
  
  if (dest.floor !== currentFloor) {
    speak(`Please take the lift to ${dest.floor}.`);
    drawLiftRoute(dest);
  } else {
    drawPath(dest);
  }
}

function drawLiftRoute(dest) {
  drawMall();
  const lift = mallData[currentFloor].find(s => s.name === "üõó Lift");
  const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
  const d = `M60,560 L${lift.x + 40},${lift.y + 25}`;
  path.setAttribute("d", d);
  path.setAttribute("class", "path");
  svg.appendChild(path);

  animateDot(path, () => {
    speak("Now moving to first floor via lift.");
    setTimeout(() => {
      currentFloor = dest.floor;
      document.getElementById("floorSelect").value = dest.floor;
      drawMall();
      drawPath(dest);
    }, 2500);
  });
}

function drawPath(dest) {
  drawMall();
  const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
  const d = `M60,560 L${dest.x + 40},${dest.y + 25}`;
  path.setAttribute("d", d);
  path.setAttribute("class", "path");
  svg.appendChild(path);
  animateDot(path, () => speak(`You have reached ${dest.name}.`));
}

function animateDot(path, callback) {
  if (movingDot) movingDot.remove();
  movingDot = document.createElementNS("http://www.w3.org/2000/svg", "circle");
  movingDot.setAttribute("r", 8);
  movingDot.setAttribute("fill", "#ff0077");
  svg.appendChild(movingDot);

  const length = path.getTotalLength();
  let progress = 0;
  function step() {
    const point = path.getPointAtLength(progress);
    movingDot.setAttribute("cx", point.x);
    movingDot.setAttribute("cy", point.y);
    progress += 3;
    if (progress <= length) requestAnimationFrame(step);
    else if (callback) callback();
  }
  step();
}

drawMall();
populateDestinations();
</script>

</body>
</html>
